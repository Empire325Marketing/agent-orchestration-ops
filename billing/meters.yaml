# Usage Meters Definition
version: 1
meters:
  tokens_in:
    unit: "tokens"
    description: "Input tokens processed by LLM"
    attribution: ["tenant_id", "route", "tool", "model"]
    granularity: "per_request"
    aggregation: "sum"
    retention: "13_months"
    
  tokens_out:
    unit: "tokens" 
    description: "Output tokens generated by LLM"
    attribution: ["tenant_id", "route", "tool", "model"]
    granularity: "per_request"
    aggregation: "sum"
    retention: "13_months"
    
  tool_calls:
    unit: "calls"
    description: "External API tool invocations"
    attribution: ["tenant_id", "route", "tool", "endpoint"]
    granularity: "per_call"
    aggregation: "count"
    retention: "13_months"
    
  images_generated:
    unit: "images"
    description: "AI-generated images"
    attribution: ["tenant_id", "route", "model", "size"]
    granularity: "per_image"
    aggregation: "count"
    retention: "13_months"
    
  egress_bytes:
    unit: "bytes"
    description: "Data transferred out via proxy"
    attribution: ["tenant_id", "route", "destination"]
    granularity: "per_request"
    aggregation: "sum"
    retention: "13_months"

# Extensibility for future meters
extensibility:
  custom_meters:
    - "storage_bytes: persistent data storage"
    - "compute_seconds: CPU/GPU time consumption"
    - "embeddings_generated: vector embeddings created"
  attribution_fields:
    - "user_id: per-user attribution within tenant"
    - "session_id: session-based grouping"
    - "feature_flag: A/B test attribution"
