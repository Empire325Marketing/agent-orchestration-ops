# Primarch Content Policy Rules
# Comprehensive content policy configuration for enterprise guardrails

version: "1.0"
last_updated: "2025-09-30"

# ======================
# SECURITY POLICIES
# ======================

security:
  jailbreak_protection:
    enabled: true
    severity: "critical"
    confidence_threshold: 0.8
    patterns:
      - "ignore previous instructions"
      - "pretend you are not an AI"
      - "roleplay as someone else"
      - "forget your guidelines"
      - "act as if you have no restrictions"
      - "bypass security"
      - "system prompt override"
    response: "I cannot comply with requests that attempt to bypass my guidelines or security measures."
    
  prompt_injection:
    enabled: true
    severity: "critical"
    patterns:
      - "\\n\\nHuman:"
      - "\\n\\nAssistant:"
      - "System:"
      - "IGNORE EVERYTHING ABOVE"
      - "NEW INSTRUCTIONS:"
    response: "This request appears to contain prompt injection attempts and cannot be processed."
    
  code_injection:
    enabled: true
    severity: "critical"
    patterns:
      - "eval\\("
      - "exec\\("
      - "__import__"
      - "subprocess"
      - "os\\.system"
      - "<script>"
    response: "I cannot execute or help with code that could pose security risks."

# ======================
# CONTENT CATEGORIES
# ======================

content_categories:
  violence_hate:
    enabled: true
    severity: "critical"
    subcategories:
      - violence_threats
      - hate_speech
      - harassment
      - discrimination
      - self_harm_instructions
    keywords:
      - "kill"
      - "murder"
      - "assault"
      - "hate"
      - "terrorist"
      - "bomb"
    response: "I cannot provide content that promotes violence, hate, or harm to individuals or groups."
    
  sexual_content:
    enabled: true
    severity: "high"
    subcategories:
      - explicit_content
      - exploitation
      - inappropriate_material
      - non_consensual_content
    age_verification: true
    response: "I cannot provide sexual or adult content."
    
  criminal_planning:
    enabled: true
    severity: "critical"
    subcategories:
      - illegal_activities
      - fraud_schemes
      - money_laundering
      - terrorism_planning
      - cybercrime
    keywords:
      - "illegal"
      - "fraud"
      - "scam"
      - "hack"
      - "steal"
    response: "I cannot assist with planning or executing illegal activities."
    
  regulated_substances:
    enabled: true
    severity: "high"
    subcategories:
      - drug_manufacturing
      - substance_abuse
      - prescription_fraud
      - controlled_substances
    keywords:
      - "drugs"
      - "cocaine"
      - "heroin"
      - "methamphetamine"
      - "prescription fraud"
    response: "I cannot provide information about illegal drug manufacturing or substance abuse."
    
  weapons_explosives:
    enabled: true
    severity: "critical"
    subcategories:
      - weapon_manufacturing
      - explosive_devices
      - firearm_trafficking
      - dangerous_chemicals
    keywords:
      - "bomb"
      - "explosive"
      - "weapon"
      - "gun manufacturing"
      - "dangerous chemicals"
    response: "I cannot provide instructions for creating weapons or explosive devices."

# ======================
# PRIVACY PROTECTION
# ======================

privacy:
  pii_detection:
    enabled: true
    severity: "high"
    data_types:
      - social_security_number
      - credit_card_number
      - bank_account_number
      - passport_number
      - driver_license
      - phone_number
      - email_address
      - home_address
    patterns:
      ssn: "\\b\\d{3}-?\\d{2}-?\\d{4}\\b"
      credit_card: "\\b(?:\\d{4}[- ]?){3}\\d{4}\\b"
      email: "\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b"
      phone: "\\b(?:\\+?1[-. ]?)?\\(?\\d{3}\\)?[-. ]?\\d{3}[-. ]?\\d{4}\\b"
    action: "redact"
    replacement: "[REDACTED]"
    
  sensitive_data:
    enabled: true
    severity: "high"
    categories:
      - financial_information
      - medical_records
      - legal_documents
      - personal_communications
      - biometric_data
    response: "I cannot process requests involving sensitive personal data."

# ======================
# ENTERPRISE POLICIES
# ======================

enterprise:
  data_classification:
    enabled: true
    levels:
      public:
        allowed_actions: ["read", "process", "share"]
        restrictions: []
      internal:
        allowed_actions: ["read", "process"]
        restrictions: ["no_external_sharing"]
      confidential:
        allowed_actions: ["read"]
        restrictions: ["no_processing", "no_sharing", "audit_required"]
      restricted:
        allowed_actions: []
        restrictions: ["no_access", "executive_approval_required"]
        
  compliance_frameworks:
    gdpr:
      enabled: true
      data_subject_rights: true
      consent_required: true
      retention_limits: true
      breach_notification: true
      
    hipaa:
      enabled: true
      phi_protection: true
      minimum_necessary: true
      audit_trails: true
      
    sox:
      enabled: true
      financial_data_protection: true
      audit_requirements: true
      segregation_of_duties: true
      
    pci_dss:
      enabled: true
      payment_data_protection: true
      encryption_required: true
      access_controls: true
      
  business_rules:
    working_hours:
      enabled: true
      start_time: "08:00"
      end_time: "18:00"
      timezone: "UTC"
      emergency_override: true
      
    content_approval:
      enabled: true
      required_for:
        - "external_communications"
        - "financial_statements"
        - "legal_advice"
        - "medical_guidance"
      approvers:
        - "legal_team"
        - "compliance_officer"
        - "executive_team"
        
    resource_limits:
      enabled: true
      max_processing_time: 300  # seconds
      max_response_length: 10000  # characters
      max_concurrent_requests: 50

# ======================
# QUALITY ASSURANCE
# ======================

quality:
  factual_accuracy:
    enabled: true
    fact_checking: true
    source_verification: true
    confidence_threshold: 0.8
    
  response_quality:
    enabled: true
    minimum_quality_score: 0.7
    coherence_check: true
    relevance_check: true
    
  bias_detection:
    enabled: true
    categories:
      - gender_bias
      - racial_bias
      - age_bias
      - religious_bias
      - political_bias
    mitigation: "rewrite_neutral"

# ======================
# MONITORING & ALERTS
# ======================

monitoring:
  violation_tracking:
    enabled: true
    alert_thresholds:
      critical: 1  # Alert immediately
      high: 5      # Alert after 5 violations
      medium: 20   # Alert after 20 violations
      low: 100     # Alert after 100 violations
      
  metrics_collection:
    enabled: true
    metrics:
      - "violation_count"
      - "violation_type"
      - "processing_time"
      - "user_behavior"
      - "content_categories"
      
  audit_logging:
    enabled: true
    log_level: "detailed"
    retention_days: 90
    fields:
      - timestamp
      - user_id
      - tenant_id
      - request_hash
      - violation_type
      - action_taken
      - confidence_score

# ======================
# RESPONSE TEMPLATES
# ======================

responses:
  policy_violation:
    default: "I cannot process this request as it violates our content policy."
    security: "This request has been blocked due to security policy violations."
    privacy: "I cannot process requests involving sensitive personal information."
    compliance: "This request cannot be completed due to regulatory compliance requirements."
    
  escalation:
    human_required: "This request requires human review. It has been forwarded to our support team."
    approval_needed: "This request requires approval from authorized personnel."
    
  error_handling:
    processing_error: "I encountered an error while processing your request. Please try again."
    timeout: "Your request timed out. Please try with a simpler query."
    rate_limit: "You have exceeded the request rate limit. Please wait before trying again."

# ======================
# CUSTOMIZATION
# ======================

customization:
  tenant_overrides:
    enabled: true
    inheritance: "merge"  # "merge" or "override"
    
  user_preferences:
    enabled: true
    override_policies: false  # Users cannot override security policies
    
  context_awareness:
    enabled: true
    factors:
      - user_role
      - time_of_day
      - request_context
      - historical_behavior
      
  dynamic_policies:
    enabled: true
    ml_based_updates: true
    feedback_learning: true
    policy_evolution: true

# ======================
# EMERGENCY PROCEDURES
# ======================

emergency:
  incident_response:
    enabled: true
    escalation_levels:
      - "security_team"
      - "compliance_officer" 
      - "ciso"
      - "executive_team"
      
  circuit_breaker:
    enabled: true
    triggers:
      - high_violation_rate: ">10/minute"
      - critical_security_event: ">0"
      - system_compromise_detected: ">0"
    actions:
      - "block_all_requests"
      - "notify_security_team"
      - "enable_manual_review"
      
  disaster_recovery:
    enabled: true
    fallback_policies: "strict_block_all"
    recovery_procedures: true
    business_continuity: true

# ======================
# CONFIGURATION VALIDATION
# ======================

validation:
  schema_version: "1.0"
  required_fields: ["security", "content_categories", "privacy", "enterprise"]
  checksum: "sha256:a1b2c3d4e5f6..."  # Configuration integrity check
  last_validated: "2025-09-30T18:20:00Z"
  validation_status: "passed"
